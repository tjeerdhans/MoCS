@using Microsoft.AspNet.Identity
@model IEnumerable<MoCS.Web.Models.TeamModel>
@{
    ViewBag.Title = "Teams";
}

<h2>@ViewBag.Title</h2>
<div class="container">
    <div class="row">
        <div class="col-xs-8">
            <table class="table table-condensed table-striped">
                <thead>
                    <tr>
                        <th>Team name</th>
                        <th>Score</th>
                        <th>Admin user</th>
                        <th>Team members</th>
                        <th></th>
                    </tr>
                </thead>
                @foreach (var team in Model)
                {
                    <tr title="Description: @team.Description">
                        <td>@team.Name</td>
                        <td>@team.Score</td>
                        <td>@team.AdminUserName</td>
                        <td>@string.Join(", ", team.TeamMemberNames)</td>
                        <td>
                            @if (team.AdminUserId == User.Identity.GetUserId() || User.IsInRole("Admin"))
                            {
                                using (Html.BeginForm("Delete", "Teams", new { id = team.Id }))
                                {
                                    @Html.AntiForgeryToken()
                                    <a href="@Url.Action("Edit", new { id =  team.Id })" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-pencil" title="Edit this team"></span></a>
                                    <button type="submit" onclick="return confirm('Are you sure you want to delete this team?');" class="btn btn-default btn-sm" title="Delete this team"><span class="glyphicon glyphicon-trash" title="Delete this team"></span></button>
                                }
                            }
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
</div>
<a href="@Url.Action("Add")" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-plus"></span> Add team</a>
